<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      class="light-style layout-navbar-fixed layout-menu-fixed"
      dir="ltr"
      data-theme="theme-default"
      data-template="vertical-menu-template-no-customizer">
<head th:replace="~{layout/layout :: head}"></head>
<body>
<div class="authentication-wrapper authentication-basic px-4">
    <div class="authentication-inner py-4">
        <div class="card">
            <div class="card-body">
                <!-- Logo -->
                <div class="app-brand justify-content-center mb-4 mt-2">
                    <div class="app-brand-link">
                <span class="app-brand-logo demo">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 106"><defs><style>.cls-1 {
                        fill: #fff;
                    }

                    .cls-2 {
                        fill: #ffc868;
                    }

                    .cls-3 {
                        fill: #12adb8;
                    }

                    .cls-4 {
                        fill: #ff7575;
                    }

                    .cls-5 {
                        opacity: 0.1;
                    }

                    .cls-6 {
                        fill: #171c1f;
                    }

                    .cls-7 {
                        opacity: 0.15;
                    }</style></defs><title>home</title><g id="Home"><g id="Fill"><path class="cls-1"
                                                                                       d="M53,19,15,49V98a6,6,0,0,0,6,6H85a6,6,0,0,0,6-6V49Z"/></g>
                   <g id="Yellow">
                       <path class="cls-2" d="M17,96v2a4,4,0,0,0,4,4H85a4,4,0,0,0,4-4V96Z"/>
                   </g>
                   <g id="Orange">
                       <polygon class="cls-3" points="53 2 2 43 2 59 53 19 104 59 104 43 53 2"/>
                   </g>
                   <g id="Red">
                       <path class="cls-4" d="M63,64H43a2,2,0,0,0-2,2v36H65V66A2,2,0,0,0,63,64Z"/>
                   </g>
                   <g id="Shadows" class="cls-5">
                       <path d="M85,100H21a4,4,0,0,1-4-4v2a4,4,0,0,0,4,4H85a4,4,0,0,0,4-4V96A4,4,0,0,1,85,100ZM54.29,21.47h0a2,2,0,0,0-2.57,0h0L17,48.7v5.08L53,25.54,89,53.78V48.7Z"/></g><g
                                id="Inner_Lines_1" data-name="Inner Lines 1"><path class="cls-6"
                                                                                   d="M17,96H39V94H17ZM58,83a1,1,0,1,0,1,1A1,1,0,0,0,58,83Zm9,11v2H89V94Z"/></g><g
                                id="Inner_Lines_2" data-name="Inner Lines 2" class="cls-7"><path class="cls-6"
                                                                                                 d="M6,55H8V39H6Zm31,1H32a1,1,0,0,0,0,2h5a1,1,0,0,0,0-2ZM27,78H23a1,1,0,0,0,0,2h4a1,1,0,0,0,0-2ZM26,53h8a1,1,0,0,0,0-2H26a1,1,0,0,0,0,2ZM98,39V55h2V39ZM84,68H76a1,1,0,0,0,0,2h8a1,1,0,0,0,0-2ZM57,38H54a1,1,0,0,0,0,2h3a1,1,0,0,0,0-2ZM78,83H74a1,1,0,1,0,0,2h4a1,1,0,1,0,0-2ZM70,53H64a1,1,0,0,0,0,2h6a1,1,0,0,0,0-2Z"/></g><g
                                id="Outline"><path class="cls-6"
                                                   d="M105.29,41.48h0l-51-41h0a2,2,0,0,0-2.58,0h0l-51,41h0A2,2,0,0,0,0,43V59a2,2,0,0,0,3.28,1.52h0L13,52.91V98a8,8,0,0,0,8,8H85a8,8,0,0,0,8-8V52.91l9.71,7.62h0A2,2,0,0,0,106,59V43A2,2,0,0,0,105.29,41.48ZM63,102H43V66H63Zm26-4a4,4,0,0,1-4,4H67V66a4,4,0,0,0-4-4H43a4,4,0,0,0-4,4v36H21a4,4,0,0,1-4-4V49.78L53,21.54,89,49.78Zm13-43.11L54.29,17.47h0a1.94,1.94,0,0,0-2-.35h0a2,2,0,0,0-.58.34h0L4,54.89V44L53,4.57,102,44Z"/></g></g></svg>
                          </span>
                        <span class="app-brand-text demo text-body fw-bold">Мій Дім 24</span>
                    </div>
                </div>
                <!-- /Logo -->
                <form id="formAuthentication">
                    <div class="mb-3 form-password-toggle">
                        <label class="form-label" for="password">Новий пароль</label>
                        <div class="input-group input-group-merge">
                            <input
                                    type="password"
                                    id="password"
                                    class="form-control"
                                    name="password"
                                    placeholder="&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;"
                                    maxlength="8">
                            <span class="input-group-text cursor-pointer"><i class="ti ti-eye-off"></i></span>
                        </div>
                        <div class="text-danger" id="passwordValidation"></div>
                    </div>
                    <div class="mb-3 form-password-toggle">
                        <label class="form-label" for="confirm-password">Підтвердіть пароль</label>
                        <div class="input-group input-group-merge">
                            <input
                                    type="password"
                                    id="confirm-password"
                                    class="form-control"
                                    name="confirm-password"
                                    placeholder="&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;"
                                    maxlength="8"
                            >
                            <span class="input-group-text cursor-pointer"><i class="ti ti-eye-off"></i></span>
                        </div>
                        <div class="text-danger" id="confirmPasswordValidation"></div>
                    </div>
                    <button type="button" class="btn btn-primary d-grid w-100 mb-3" onclick="send()">Зберегти новий
                        пароль
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
</body>
<script th:src="@{/assets/vendor/libs/jquery/jquery.js}"></script>
<script th:src="@{/assets/vendor/libs/popper/popper.js}"></script>
<script th:src="@{/assets/vendor/js/bootstrap.js}"></script>
<script th:src="@{/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js}"></script>
<script th:src="@{/assets/vendor/libs/node-waves/node-waves.js}"></script>
<script th:src="@{/assets/vendor/libs/hammer/hammer.js}"></script>
<script th:src="@{/assets/vendor/libs/typeahead-js/typeahead.js}"></script>
<script th:src="@{/assets/vendor/libs/select2/select2.js}"></script>
<script th:src="@{/assets/vendor/libs/toastr/toastr.js}"></script>

<script th:src="@{/assets/vendor/js/menu.js}"></script>

<script th:src="@{/assets/js/main.js}"></script>
<script th:inline="javascript">
    var token = [[${token}]];
    function send() {
        $("#passwordValidation").text("");
        $("#password").removeClass("is-invalid");
        $("#confirmPasswordValidation").text("");
        $("#confirm-password").removeClass("is-invalid");
        if ($("#password").val().localeCompare('') == 0 || $("#confirm-password").val().localeCompare('') == 0 || $("#password").val().localeCompare($("#confirm-password").val()) != 0) {
            if ($("#password").val().localeCompare('') == 0) {
                $("#passwordValidation").text("Поле не може бути порожнім");
                $("#password").addClass("is-invalid");
            }
            if ($("#password").val().localeCompare($("#confirm-password").val()) != 0) {
                $("#confirmPasswordValidation").text("Невірний пароль");
                $("#confirm-password").addClass("is-invalid");
            }
            if ($("#confirm-password").val().localeCompare('') == 0) {
                $("#confirmPasswordValidation").text("Поле не може бути порожнім");
                $("#confirm-password").addClass("is-invalid");
            }
        } else {
            $.ajax({
                type: "POST",
                url: "changePassword",
                data: {
                    token: token,
                    password: $("#password").val()
                },
                success: function () {
                    window.location.href = 'success';
                },
                error: function (XMLHttpRequest) {
                    if(XMLHttpRequest.status == 400){
                        window.location.href = 'tokenExpired';
                    }
                }
            });
        }
    }
</script>
</html>